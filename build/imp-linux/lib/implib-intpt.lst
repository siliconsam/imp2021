         Edinburgh IMP77 Compiler - Version 8.4

   1  {----------------------------------------------------------------------------}
   2      ! INTPT - return the integer part of a real.  Note that this is
   3      ! NOT the same as the built-in primitive "INT" which returns the
   4      ! nearest integer to the real according to IEEE rounding rules.
   5      ! Thus, INTPT(1.9) = 1, whereas INT(1.9) = 2.  INTPT uses INT
   6      ! and then adjusts the rounding to truncate.
   7      %external %integer %function Int Pt(%longreal x)
   8          %integer i
   9  
   10          i = int(x)
   11          %if i # 0 %then %start; ! zero is the easy answer
   12              x = x - i
   13              %if i > 0 %start; ! correct towards zero - depends which way that is :-)
   14                  %if x < 0 %then i = i - 1
   15              %else
   16                  %if x > 0 %then i = i + 1
   17              %finish
   18          %finish
   19          %result = i
   20      %end
   21  
   22  {----------------------------------------------------------------------------}
   23  %endoffile

   14 Statements compiled
