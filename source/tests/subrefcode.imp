
    %include "inc.diag"
    %include "inc.386.registers"

    %external %integer %spec bilbo

    %external %integer %function frodoimp
        %result = bilbo + 2
    %end

    %external %integer %function frodointel
        %integer result

        *MOV_ eax,bilbo
        *ADD_ eax,#2
        *MOV_ result,eax

        %result = result
    %end

    %external %integer %function baggins ( %integer gandalf, mode )
        %if mode = 0 %start
            %result = gandalf + frodoimp
        %else
            %result = gandalf + frodointel
        %finish
    %end

%endoffile
